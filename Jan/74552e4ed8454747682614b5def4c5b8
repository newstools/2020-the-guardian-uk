Iran’s embattled regime was shaken by a wave of international condemnation and domestic criticism on Saturday night after admitting its forces shot down a Ukrainian passenger plane with 176 people on board and lied in a bid to cover up its role in the tragedy. Facing possibly the biggest crisis since the 1979 Islamic revolution, senior clerical, political and military leaders scrambled to contain the fallout from what President Hassan Rouhani termed a “disastrous mistake”. But this latest crisis, coming close on the heels of Donald Trump’s assassination of Gen Qassem Suleimani, military clashes with the US in Iraq and nationwide anti-government protests in which hundreds of people have died, appeared to force the regime on to the defensive. On Saturday night the UK ambassador to Iran, Robert Macaire, was arrested during demonstrations in front of Amir Kabir University in Tehran for “inciting” protesters. The Iranian Tasnim news agency said he was released after a few hours. Dominic Raab, the UK foreign secretary, said: “The arrest of our ambassador in Tehran without grounds or explanation is a flagrant violation of international law.” Donald Trump, who has said he does not seek “regime change” in Iran, expressed his support for the demonstrators, writing: “We are following your protests closely, and are inspired by your courage. “The government of Iran must allow human rights groups to monitor and report facts from the ground on the ongoing protests by the Iranian people. There can not be another massacre of peaceful protesters, nor an internet shutdown. The world is watching.” Iran’s military released a statement via the official Irna news agency in the early hours of Saturday admitting the “unforgivable mistake” of shooting down Ukraine International Airlines Flight 752 on Wednesday. The mea culpa came after three days of denials from officials in Tehran, who repeatedly dismissed western intelligence reports pointing to Iranian culpability as propaganda amid soaring tensions with the US. In an unprecedented move, Supreme Leader Ayatollah Ali Khamenei ordered an investigation into the hitherto untouchable Islamic revolutionary guard corps (IRGC), whose base outside Tehran launched the missile that downed Flight 752. A senior IRGC commander, Amir Ali Hajizadeh, confessed publicly that he knew the plane had been shot down almost immediately, and asked for forgiveness. His statement was broadcast on YouTube. Gen Hajizadeh, the head of the IRGC aerospace division, apologised to the nation on television and said the group took full responsibility, saying he wished “I could die” when he heard about the incident. A missile operator acting alone because of a “communications breakdown” had mistaken the Boeing 737 for a cruise missile heading towards a sensitive IRGC site, and only had 10 seconds to decide whether to fire, he said. “He was obliged to make contact and get verification. But apparently, his communications system had some disruptions. Either the ‘jamming’ system was the cause or the network was busy,” he said. After repeating in interviews the official line that no missiles had been fired in the timeframe that could have caused the crash, Iran’s ambassador to the UK, Hamid Baeidinejad, apologised, expressing “regret for conveying such wrong findings”. The regime’s apologies and promises to punish the culprits did little to staunch a flood of anger. Iranians used social media to vent their fury at being misled, while foreign governments accused Tehran of criminal irresponsibility. There is mounting anger that the retaliatory strikes launched by Iran on US military bases in Iraq were finely calibrated to ensure no US casualties, but scores of Iranian and Iranian-Canadian passengers were killed by their own forces. Videos posted on social media showed hundreds of people gathering to protest at several universities, where students shouted “Khamenei is over” and called his government “shameless”. In a rare report on the civil unrest, the semi-official Fars news agency said that demonstrators had ripped up pictures of the slain commander Suleimani. Internationally, Ukraine’s government demanded justice for the victims, including compensation. The US secretary of state, Mike Pompeo, tweeted his support for the Iranian people, who he said were “fed up with the regime’s lies, corruption, ineptitude, and brutality”. Canada’s prime minister, Justin Trudeau, said he was “outraged and furious” and said Iran “must take full responsiblity” for the “horrific” incident. Trudeau said that Iran’s president, Hassan Rouhani, had told him in a phone call that Iran was committed to collaborating with Canadian investigators and would work to de-escalate tensions in the region. Apparently alarmed at the scale of the backlash, state television suggested the tragedy was being used by Iran’s enemies to undermine it. But Britain was among several countries suggesting that the admission could pave the way for renewed dialogue. Boris Johnson said it was an “important first step” that “reinforces the importance of de-escalating tensions in the region.” The prime minister also echoed his Ukrainian and Canadian counterparts in calling for a “comprehensive, transparent and independent international investigation” into the tragedy. The aircraft was targeted by two surface-to-air missiles three minutes after taking off from an airport on the outskirts of Tehran. It took to the air a few hours after Iran launched a barrage of ballistic missiles at US targets in Iraq and the military were braced for possible reprisals. The plane, en route to the Ukrainian capital, Kyiv, was carrying 167 passengers and nine crew members from several countries, including 82 Iranians, at least 57 Canadians, 11 Ukrainians and three Britons. The Iranian strikes on Iraqi bases last week were in turn retaliation for the US drone strike that killed the al-Quds force leader, Suleimani, in Baghdad on 3 January – the culmination of a recent series of tit-for-tat attacks that threatened to push Washington and Tehran into war. Iran’s admission was met with some relief by investigators and victims’ families, who had initially feared the truth about what happened to the aircraft would be obstructed, as has been the case with the Malaysia Airlines flight downed in Ukraine six years ago. However, explanations from Iranian officials so far have raised fresh questions about why and how the commercial flight was targeted, and why it took so long for Iran to take responsibility. Flight tracking website FlightRadar24 showed the plane following its normal route and travelling at just over 500 kmh – far slower than a cruise missile. Nine flights had left Tehran’s Imam Khomeini international airport that morning before the Ukrainian airliner without encountering trouble. Air crash experts have raised serious concerns since the accident over the handling of the crash site, including the removal of debris, sparking fears that Tehran has sought to eliminate evidence from the area. Additional reporting by Leyland Cecco in Toronto.
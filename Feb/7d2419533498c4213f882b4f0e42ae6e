The chief secretary to the Treasury has rejected the idea that cuts to prison and probation services have made it harder to rehabilitate or monitor terrorism suspects after a man who left prison days ago was shot dead by police after he stabbed two people in London. Rishi Sunak declined to reveal the measures that Boris Johnson or the home secretary, Priti Patel, would announce on Monday after the attack by Sudesh Amman on Streatham High Road. The 20-year-old had been freed after serving half of his sentence of more than three years for the possession and distribution of extremist material and was under active police surveillance. The attack left one person initially in a life-threatening condition. Three victims were taken by ambulance to south London hospitals. One man, in his 40s, was no longer considered to be in a life-threatening condition after treatment, police said. A woman, in her 50s, who had non-life-threatening injuries has been discharged from hospital. Police said a second woman in her 20s, who sustained minor injuries believed to have been caused by glass after the discharge of a police firearm, was still receiving treatment. After a similar attack in late November, when the former terrorist prisoner Usman Khan stabbed and killed two people in London Bridge, Johnson promised longer sentences and moves to prevent the early release of convicted terrorists. On Sunday night the prime minister said he would announce further plans for fundamental changes to the system for dealing with those convicted of terrorism offences. The London mayor said he was alarmed that Amman had been freed even though he was considered a sufficient danger to be followed by armed police. “Why didn’t the probation service, the prison service, properly punish and reform him?” Sadiq Khan told BBC1’s Breakfast. “And also, why was he allowed to be released if the authorities knew he was a danger?” Speaking earlier, on ITV’s Good Morning Britain, he said the attack was “clearly foreseeable”. “But for an inch this way or that way, but for the brilliance of the medics and the speed of the police, there would have been two fatalities and many more,” Khan said. “And that’s one of the reasons why I’m not just frustrated but I’m angry at the changes made in the past and the lack of progress in making the changes we were promised in November.” Sunak gave no details of what extra measures would be announced by Johnson. “Today he will outline some more, and in regard to all of this, people should be under no illusion about our determination to keep everybody safe,” he told Breakfast. Sunak denied that cuts to prison and probation services were a key part of the problem. In December the former chief inspector of prisons, Nick Hardwick, said the service had been “haemorrhaging experienced staff and struggling with chaotic reforms”. Sunak said: “The counter-terrorism budget, which is what we’re dealing with here, has actually been increased every year for the last five or six years. “It is now up 30% or 40% from where it was several years ago. And we just announced a 10% increase, taking to almost £1bn for the forthcoming year.” He said the government was doubling the number of specific counter-terrorism probation officers and creating new places in probationary hostels. “This is all forming part of the plans that we’re putting in place to keep people safe.” Later, on Sky News, Sunak said the release of terrorists was dictated by the law. “In terms of changing when people are released, that does require an act of parliament – it requires a new law,” he said. “And we’ve committed to it being one of the first acts we will bring forward, within 100 days, it will be exactly that. No attacks are acceptable, which is why we’re acting as quickly as we can to put in place a new set of measures.” In his interview, Khan said the courts needed more powers to deal with such cases. “The question that I’m asking is: why was there a need for this man to be under the close supervision that he was, with an armed team?” he said. “If the authorities knew he was a danger, why didn’t the judge have the tools at his or her disposal to give this person a sentence commensurate with what he was accused of doing?” Mobile phone footage of the incident showed officers wearing plain clothes arriving on the scene at high speed, firing about five gunshots and killing Amman outside a branch of the chemist Boots. They were carrying pistols that are normally used by surveillance officers. Police continued investigations overnight, with search warrants being carried out at two addresses in south London and Bishop’s Stortford. Amman pledged allegiance to Islamic State in messages to his girlfriend at the time he was jailed, and said he wanted to carry out terrorist attacks. He wrote to her: “If you can’t make a bomb because family, friends or spies are watching or suspecting you, take a knife, molotov, sound bombs or a car at night and attack.” Comments from police officers at the time suggested there were serious concerns about Amman’s determination to die as a “martyr”. The acting commander, Alexis Boon, then head of the Metropolitan police’s counter-terrorism command, said Amman had a “fierce interest in violence and martyrdom”. In another echo of Khan’s attack, Amman was wearing a fake suicide vest, described by some witnesses as containing canister-like objects. Police said they were able to establish quickly it was a hoax device after the attacker had been shot.